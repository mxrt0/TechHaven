@model DetailsViewModel
@{
    ViewData["Title"] = Model.Product.Name;
}

@section Back {
    <button class="back-btn" onclick="history.back()">
        ← Back
    </button>
}
@section PageCss {
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" asp-append-version="true" />
}
<section class="container my-5">

    <nav class="mb-4">
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a asp-controller="Home" asp-action="Index">Home</a>
            </li>
            <li class="breadcrumb-item">
                <a asp-controller="Products" asp-action="Index">
                    Products
                </a>
            </li>
            <li class="breadcrumb-item active">
                @Model.Product.Name
            </li>
        </ol>
    </nav>

    <div class="row g-5">
        <div class="col-12 col-lg-6">
            <div class="product-image-card">
                <img src="@Model.Product.ImageUrl"
                     alt="@Model.Product.Name" />
            </div>
        </div>

        <div class="col-12 col-lg-6">
            <div class="product-info">

                <div class="product-category">
                    @Model.Product.Category
                </div>

                <h1 class="product-title mb-3">
                    @Model.Product.Name
                </h1>

                <div class="product-price mb-4">
                    @Model.Product.Price.ToString("0.00") &euro;
                </div>

                <p class="product-description">
                    @Model.Product.Description
                </p>

                <div class="stock-status mb-4">
                    @if (Model.Product.StockQuantity > 0)
                    {
                        <span class="in-stock">
                            In stock (@Model.Product.StockQuantity)
                        </span>
                    }
                    else
                    {
                        <span class="out-of-stock">
                            Out of stock
                        </span>
                    }
                </div>
                <div class="action-buttons">
                    @if (User?.Identity?.IsAuthenticated ?? false)
                    {
                  
                         <button class="btn btn-primary btn-lg wishlist-btn"
                                    data-product-id="@Model.Product.Id">
                            <i class="bi @(Model.IsInWishlist ? "bi-heart-fill text-danger" : "bi-heart")"
                                   title="@(Model.IsInWishlist
                                            ? "Remove From Wishlist"
                                            : "Add To Wishlist")">
                            </i>
                         </button>
                     }
                     <div class="d-inline-flex align-items-center gap-2">
                        @Html.AntiForgeryToken()
                        <input type="hidden"
                               name="productId"
                               value="@Model.Product.Id"/>                       

                        <button type="submit"
                                class="btn btn-cart @(Model.IsInCart ? "btn-remove" : "")"
                                @(Model.Product.StockQuantity <= 0 ? "disabled" : "")>
                            @(Model.IsInCart ? "Remove From Cart" : "🛒 Add to Cart")
                        </button>

                        <input type="number" name="quantity"
                               value="1" min="1"
                               class="form-control quantity-input"
                               style="width: 70px;"
                               @(Model.IsInCart ? "disabled hidden" : "")/>
                     </div>
                 </div>
                                
            </div>
        </div>
    </div>
    <div class="specs-section mt-5">
        <h2 class="mb-4">Specifications</h2>

        <div class="specs-card">
            <table class="table table-borderless mb-0">
                <tbody>
                    @foreach (var spec in Model.Product.Specs)
                    {
                        <tr>
                            <th class="spec-key">
                                @spec.Key
                            </th>
                            <td class="spec-value">
                                @spec.Value
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

</section>

@section Scripts {    
    <script src="~/js/toast.js"></script>
    <script src="~/js/cart.js"></script>
    <script src="~/js/wishlist.js"></script>
}
